
{% extends "base.html" %}
{% block content %}
<h2 class="mb-3">Asset Running Status</h2>
<div class="card p-3 mb-4">
  <form method="post" action="{{ url_for('handle_category_upload_running_status') }}" enctype="multipart/form-data">
    <label class="form-label">Upload CSV/XLSX/XLS</label>
    <input type="file" class="form-control" name="file" required>
    <div class="mt-3 text-end"><button class="btn btn-primary">Upload</button></div>
  </form>
</div>
<div class="card p-3">
  <h5>Recent Uploads</h5>
  <div class="table-responsive">
    <table class="table table-dark table-striped align-middle">
      <thead><tr><th>ID</th><th>Filename</th><th>Saved As</th><th>Size</th><th>Uploaded By</th><th>At</th></tr></thead>
      <tbody>
      {% for f in files %}
        <tr>
          <td>{{ f.id }}</td><td>{{ f.filename }}</td><td><a href="{{ url_for('download_upload', name=f.saved_as) }}">{{ f.saved_as }}</a></td><td>{{ (f.size_bytes/1024/1024)|round(2) }} MB</td><td>{{ f.uploaded_by }}</td><td>{{ f.uploaded_at }}</td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>
</div>
<div class="card p-3 mt-4">
  <h5>Preview (latest file)</h5>
  {% if preview_error %}<div class="alert alert-warning">Preview error: {{ preview_error }}</div>{% endif %}
  {% if preview_rows %}
    <div class="table-responsive"><table class="table table-dark table-striped"><thead><tr>{% for h in preview_headers %}<th>{{ h }}</th>{% endfor %}</tr></thead><tbody>{% for row in preview_rows %}<tr>{% for cell in row %}<td>{{ cell }}</td>{% endfor %}</tr>{% endfor %}</tbody></table></div>
  {% else %}<p class="text-secondary">Upload a file to see a preview.</p>{% endif %}
</div>
{% endblock %}
